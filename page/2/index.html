<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="shiron" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="shiron">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="shiron">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="shiron">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/2/"/>


  <title> shiron </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">shiron</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/19/哪部电影曾经让你在深夜中痛哭？/" itemprop="url">
                  哪部电影曾经让你在深夜中痛哭？
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-19T17:52:04+08:00" content="2016-05-19">
              2016-05-19
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>点击<a href="https://www.zhihu.com/question/37206525/answer/72868899" target="_blank" rel="external">《爆裂鼓手》</a>查看原文</p>
<p><strong>在知乎上看到这个答案非常喜欢,所以保存了下来,曾经我也以为我是很喜欢写代码的,但是看过这片文章以后才发现直接并不是那么的热爱–曾经看过一个视频问,你渴望成功?渴望的程度会想被泡在水里想要呼吸的欲望吗?</strong></p>
<p><strong>我问了自己很久,其实我也并没有那么热爱,起码不能说像呼吸那么热爱.说真的就是会觉得编程的世界很广阔,可以让我学习到很多不同的知识和认识很多很厉害的人.正是因为认识了他们,所以我才会明白自己的不足.
</strong></p>
<p><strong>然后对于生活的抉择,我也在迷茫,我也不知道要往哪里走,只是希望一切能顺顺利利的.说到身在福中不知福,突然就想到小时候没有好好的享受童年,现在等到有很大工作压力的时候才来后悔啊啊,以后一定让自己的孩子好好学习,不要浪费有趣的童年.</strong></p>
<p><strong>我本来是有很多奇奇怪怪的话要说的,但是刚刚打了一篇文章,放在了日记里面,现在不那么想说了,一份日记承载了我所以的心情,点点滴滴.回顾起来,突然想问自己,什么才叫成功,什么才叫幸福呢?我们之所以努力,不是为了过上更好的日子吗?</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/05/iOS中模拟发送http请求以及解析xml/" itemprop="url">
                  iOS中模拟发送http请求以及解析xml
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-05T13:32:33+08:00" content="2016-05-05">
              2016-05-05
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="AFNetWorking请求"><a href="#AFNetWorking请求" class="headerlink" title="AFNetWorking请求"></a>AFNetWorking请求</h3><p>这个不难,导入AFN框架,生成一个单例类,特别要注意的是,如果作为模拟请求http请求的话,返回的并不是json数据.</p>
<h4 id="1-单例代码如下"><a href="#1-单例代码如下" class="headerlink" title="1.单例代码如下"></a>1.单例代码如下</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">import UIKit</div><div class="line"></div><div class="line">class NetworkTools: AFHTTPSessionManager &#123;</div><div class="line"></div><div class="line">		//设置单例</div><div class="line">    static let tools: NetworkTools = &#123;</div><div class="line">        </div><div class="line">        </div><div class="line">        let tool = NetworkTools()</div><div class="line">        </div><div class="line">        //设置类型</div><div class="line">        tool.responseSerializer.acceptableContentTypes =  NSSet(objects: &quot;application/json&quot;, &quot;text/html&quot;,&quot;text/json&quot;, &quot;text/javascript&quot;, &quot;text/plain&quot;,&quot;image/png&quot;) as? Set&lt;String&gt;</div><div class="line"></div><div class="line">        tool.responseSerializer = AFHTTPResponseSerializer()</div><div class="line">        </div><div class="line">        return tool</div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    //获取单例</div><div class="line">    class func shareNetworkTools() -&gt;NetworkTools&#123;</div><div class="line">        return tools</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2-发送请求"><a href="#2-发送请求" class="headerlink" title="2.发送请求"></a>2.发送请求</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">var param = [String:String]()</div><div class="line">      </div><div class="line"></div><div class="line">      NetworkTools.shareNetworkTools().post(&quot;https://www.baidu.com&quot;, parameters: param, progress: nil, success:&#123;(URLSessionDataTask, data)in</div><div class="line">          </div><div class="line">          let jsonStr = String.init(data: data as! Data, encoding: .utf8)!</div><div class="line">          </div><div class="line">          print(jsonStr)</div><div class="line">          </div><div class="line">      &#125;, failure:&#123;(URLSessionDataTask, error) in</div><div class="line">          </div><div class="line">          print(error)</div><div class="line">      &#125;);</div></pre></td></tr></table></figure>
<p>好了,在这里我们已经可以获得含有dom字节的字符串吧,保佑解析不要出错吧,这里就不作网络请求了,直接加载本地数据(为了方便查看,这里直接解析html吧):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">&lt;body&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;p&gt;测试节点&lt;/p&gt;</div><div class="line">    &lt;h1&gt;nnnnnn&lt;/h1&gt;</div><div class="line">    &lt;table&gt;</div><div class="line">      &lt;ul&gt;</div><div class="line">        &lt;li&gt;abc1&lt;/li&gt;</div><div class="line">        &lt;li&gt;abc2&lt;/li&gt;</div><div class="line">        &lt;li&gt;abc3&lt;/li&gt;</div><div class="line">        &lt;li&gt;abc4&lt;/li&gt;</div><div class="line">        &lt;li&gt;abc5&lt;/li&gt;</div><div class="line">      &lt;/ul&gt;</div><div class="line">    &lt;/table&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h3 id="GDataXMLNode解析XML"><a href="#GDataXMLNode解析XML" class="headerlink" title="GDataXMLNode解析XML"></a>GDataXMLNode解析XML</h3><h4 id="一-使用GDataXMLNode解析-必须导入文件和框架"><a href="#一-使用GDataXMLNode解析-必须导入文件和框架" class="headerlink" title="一.使用GDataXMLNode解析,必须导入文件和框架"></a>一.使用GDataXMLNode解析,必须导入文件和框架</h4><p>(OS_导入libxml2.2框架后,找不到<libxml tree.h="">的解决办法)</libxml></p>
<ol>
<li>从网上下载GDataXMLNode.h和GDataXMLNode.m,只有两个文件,下载完成后直接拉入项目中即可.(<strong>此时编译会报错误:找不到libxml tree.h</strong>)</li>
<li>下载完成后需要配置项目中的动态库,选中项目,像工程中添加”libxml2.tbd” (借一下图,感谢<a href="http://my.csdn.net/pilqc2009" target="_blank" rel="external">pilqc2009</a>)<br><img src="http://img.blog.csdn.net/20140822203855390?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="1"></li>
</ol>
<p><img src="../../images/1.png" alt=""></p>
<ol>
<li><p>切换到切换到Buiild Settings的tab里，通过搜索,找到“Linking”选项框，在里面的”Other Linker Flags”的debug 和 release 里面点击“+”，添加 “-lxml2”<br><img src="http://img.blog.csdn.net/20140822204223171?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
</li>
<li><p>跟步骤2一样，依然在Buiild Settings的tab里，通过搜索，找到 Framework Search ,添加“/usr/lib/libxml2.tbd”；</p>
</li>
<li><img src="http://img.blog.csdn.net/20140822204710075?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></li>
<li>跟步骤3一样，依然在Buiild Settings的tab里，通过搜索，在“Header Search Paths” 和 “User Header Search Paths” 里填入$(SDKROOT)/usr/include/libxml2。<br><img src="http://img.blog.csdn.net/20140822205006387?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></li>
<li>然后clean项目，就OK，可以使用了。</li>
</ol>
<p>二.导入框架以后,就可以愉快的使用GDataXMLNode来解析文件了,如上面的html结构的文档,使用如下方法进行解析:</p>
<pre><code>override func viewDidLoad() {

    super.viewDidLoad()
    //加载web预览
    let webView = UIWebView(frame: CGRect(x: 0, y: 0, width: UIScreen.main.bounds.size.width, height: UIScreen.main.bounds.size.height))
    self.view.addSubview(webView)


    let path = Bundle.main.bundlePath
    //获得基础路径
    let baseURL = NSURL.fileURL(withPath: path)
    //获取文件
    let htmlPath = Bundle.main.path(forResource: &quot;index&quot;, ofType: &quot;html&quot;)!
    //抛出错误
    do{
        //将html文件转换为文本
        let htmlCont = try NSString(contentsOfFile: htmlPath, encoding: String.Encoding.utf8.rawValue)

        //将内容显示
        webView.loadHTMLString(htmlCont as String, baseURL: baseURL)

        print(htmlCont)


        do {
            //解析该文本    
            let doc = try GDataXMLDocument.init(xmlString: htmlCont as String!, options: 0)
            //获取节点
            let root = doc.rootElement();

            print(root!)
        } catch  {
            print(&quot;解析错误&quot;)
        }

    }
    catch{
        print(&quot;URl有误,获取失败失败&quot;)
    }        
    view.backgroundColor = UIColor.red
}
</code></pre><p>打印的结果如下解析完成,喜欢怎么取都可以啦:(或得跟节点)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GDataXMLElement 0x7ff9e3f478b0: &#123;type:1 name:html xml:&quot;&lt;html&gt;&lt;body&gt;&lt;div&gt;&lt;p&gt;测试节点&lt;/p&gt;&lt;h1&gt;nnnnnn&lt;/h1&gt;&lt;table&gt;&lt;ul&gt;&lt;li&gt;abc1&lt;/li&gt;&lt;li&gt;abc2&lt;/li&gt;&lt;li&gt;abc3&lt;/li&gt;&lt;li&gt;abc4&lt;/li&gt;&lt;li&gt;abc5&lt;/li&gt;&lt;/ul&gt;&lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&quot;&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/14/UIView动画和CoreAnimation学习/" itemprop="url">
                  UIView动画和CoreAnimation学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-14T11:34:51+08:00" content="2016-04-14">
              2016-04-14
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>(注意:本文为参考刘老师博客中的心得再实践一遍的个人学习笔记,并非原创,建议查看老师写的原文,点击此处<a href="http://liuyanwei.jumppo.com/index.html" target="_blank" rel="external">阅读原文</a>)</strong></p>
<h5 id="以前在工作中一直都忽视了对动画方面的研究-现在看了一遍刘彦玮大神的博客-偶像啊啊-gt-lt-里面有关于对动画的一些博客-自己重新对动画的知识进行有体系的学习和研究-自己记录下来希望以后能够更好的使用-学习资料来源于iOS动画和特效专题"><a href="#以前在工作中一直都忽视了对动画方面的研究-现在看了一遍刘彦玮大神的博客-偶像啊啊-gt-lt-里面有关于对动画的一些博客-自己重新对动画的知识进行有体系的学习和研究-自己记录下来希望以后能够更好的使用-学习资料来源于iOS动画和特效专题" class="headerlink" title="以前在工作中一直都忽视了对动画方面的研究,现在看了一遍刘彦玮大神的博客(偶像啊啊!&gt;&lt;),里面有关于对动画的一些博客,自己重新对动画的知识进行有体系的学习和研究,自己记录下来希望以后能够更好的使用,学习资料来源于iOS动画和特效专题"></a>以前在工作中一直都忽视了对动画方面的研究,现在看了一遍<a href="http://liuyanwei.jumppo.com/index.html" target="_blank" rel="external">刘彦玮</a>大神的博客(偶像啊啊!&gt;&lt;),里面有关于对动画的一些博客,自己重新对动画的知识进行有体系的学习和研究,自己记录下来希望以后能够更好的使用,学习资料来源于<a href="http://liuyanwei.jumppo.com/2015/10/29/iOS-animation-0.html" target="_blank" rel="external">iOS动画和特效专题</a></h5><h3 id="一-从最简单的动画开始"><a href="#一-从最简单的动画开始" class="headerlink" title="一.从最简单的动画开始"></a>一.从最简单的动画开始</h3><p>在我们刚刚进入iOS的学习过程中,最先接触的,肯定是下面这个方式来做简答的动画吧!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//初始设定</div><div class="line">	animateView.frame = CGRect(x: 0, y: 0, width: 100, height: 100)</div><div class="line">	        animateView.backgroundColor = UIColor.redColor()</div><div class="line">	        </div><div class="line">	 view.addSubview(animateView)</div><div class="line"></div><div class="line">//最简答的动画是这样设置的:</div><div class="line">        </div><div class="line">      UIView.animateWithDuration(1.0, animations: &#123;</div><div class="line">          //动画效果</div><div class="line">          //颜色可以变</div><div class="line">          self.animateView.backgroundColor = UIColor.yellowColor()</div><div class="line">          //大小/位置可变</div><div class="line">          self.animateView.frame = CGRect(x: 200 , y: 200, width: 200, height: 200)</div><div class="line">          //透明度改变</div><div class="line">          self.animateView.alpha = 0.5</div><div class="line">          </div><div class="line">      &#125;) &#123; (isCompletion) in</div><div class="line">          print(&quot;动画结束&quot;)</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<p>animateWithDurationl里面有四个重载的方法,使用该方法可以实现了很多简单的功能,其中一个还有有阻尼系数和回弹系数,可以设置弹簧效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">//此方法含有阻尼系数和回弹系数</div><div class="line">        UIView.animateWithDuration(0.2, delay: 0, usingSpringWithDamping: 0.5, initialSpringVelocity: 0.5, options: UIViewAnimationOptions.CurveEaseIn, animations: &#123;</div><div class="line">            //大小/位置可变</div><div class="line">            self.animateView.frame = CGRect(x: 200 , y: 200, width: 200, height: 200)</div><div class="line">            &#125;) &#123; (isCompletion) in</div><div class="line">                print(&quot;动画结束&quot;)</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h3 id="二-Core-Animation的类图"><a href="#二-Core-Animation的类图" class="headerlink" title="二.Core Animation的类图"></a>二.Core Animation的类图</h3><p><img src="http://liuyanwei.jumppo.com/assets/uploads/animationAndEffect05.png" alt="类图"></p>
<ul>
<li><p>CAAnimation：核心动画的基础类，不能直接使用，负责动画运行时间、速度的控制，本身实现了CAMediaTiming协议。</p>
</li>
<li><p>CAPropertyAnimation：属性动画的基类（通过属性进行动画设置，注意是可动画属性），不能直接使用。</p>
</li>
<li><p>CAAnimationGroup：动画组，动画组是一种组合模式设计，可以通过动画组来进行所有动画行为的统一控制，组中所有动画效果可以并发执行。</p>
</li>
<li><p>CATransition：转场动画，主要通过滤镜进行动画效果设置。</p>
</li>
<li><p>CABasicAnimation：基础动画，通过属性修改进行动画参数控制，只有初始状态和结束状态。</p>
</li>
<li><p>CAKeyframeAnimation：关键帧动画，同样是通过属性进行动画参数控制，但是同基础动画不同的是它可以有多个状态控制。</p>
</li>
</ul>
<h3 id="基本动画CABasicAnimation"><a href="#基本动画CABasicAnimation" class="headerlink" title="基本动画CABasicAnimation"></a>基本动画CABasicAnimation</h3><p>然后按照老师的写法,再自己敲了一遍,在touchesBegan方法里面进行了尝试.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">       let baseAnimation = CABasicAnimation(keyPath: &quot;position&quot;)</div><div class="line">        //fromValue设置起点位置,不设置的时候为当前位置</div><div class="line">//        let point  = CGPoint(x: 100, y: 100)</div><div class="line">//        baseAnimation.toValue = NSValue(CGPoint: point)</div><div class="line">        baseAnimation.byValue = NSValue(CGPoint: CGPoint(x: 100, y: 100))</div><div class="line">        </div><div class="line">        //其他动画属性</div><div class="line">        baseAnimation.duration = 0.2</div><div class="line">        baseAnimation.repeatCount = 1</div><div class="line">        </div><div class="line">        //加速运动</div><div class="line">//        baseAnimation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseIn)</div><div class="line">        //自定义加速的曲线参数</div><div class="line">        baseAnimation.timingFunction = CAMediaTimingFunction(controlPoints: 0.1, 0, 0.9, 0.7)</div><div class="line">        </div><div class="line">        </div><div class="line">        //这两个属性若不设置，动画执行后回复位</div><div class="line">        baseAnimation.removedOnCompletion = false</div><div class="line">        baseAnimation.fillMode = kCAFillModeForwards</div><div class="line">        </div><div class="line">        //可以在动画中缓存一些</div><div class="line">        //baseAnimation.setValue(NSValue(CGPoint: point), forKey: &quot;startPoint&quot;)</div><div class="line">        //开始动画</div><div class="line">        animateView.layer.addAnimation(baseAnimation, forKey: &quot;TextAnimateView&quot;)</div></pre></td></tr></table></figure>
<p><img src="http://liuyanwei.jumppo.com/assets/uploads/animationAndEffect01.gif" alt=""><br>老师后来提醒了说其实动画只是layer层改变了,实际上,view上的frame还是没有改变,当你再次点击屏幕的时候,view又会回到原来的地方,重新开始这个动画.解决办法是重新设置view.frame :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//        ----------------</div><div class="line">//        此处设置的代理是为了可以让view.frame同时跟着view.layer一起改变</div><div class="line">        baseAnimation.delegate = self</div><div class="line">        </div><div class="line">        baseAnimation.setValue(NSValue(CGPoint: endPoint), forKey: &quot;endPoint&quot;)</div><div class="line">        baseAnimation.setValue(self.animateView, forKey: &quot;sender&quot;)</div><div class="line">        </div><div class="line">//        ----------------</div><div class="line">//代理方法里面可以获取到view和终点的位置</div><div class="line">override func animationDidStop(anim: CAAnimation, finished flag: Bool) &#123;</div><div class="line">        let endPoint = anim.valueForKey(&quot;endPoint&quot;)?.CGPointValue()</div><div class="line">        let theView = anim.valueForKey(&quot;sender&quot;) as! UIView</div><div class="line">        theView.layer.position = endPoint!</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>keyPath用于区分BasicAnimation动画类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line">   可选的KeyPath</div><div class="line">   transform.scale = 比例轉換 </div><div class="line">   transform.scale.x</div><div class="line">   transform.scale.y</div><div class="line">   &#123;</div><div class="line">    //CABasicAnimation(keyPath: &quot;transform.scale&quot;)</div><div class="line">    //CABasicAnimation(keyPath: &quot;transform.scale.x&quot;)</div><div class="line">    //CABasicAnimation(keyPath: &quot;transform.scale.y&quot;)</div><div class="line">    //初始大小</div><div class="line">    transformAnimation.fromValue = NSNumber(float: 1.0)</div><div class="line">    //最终大小</div><div class="line">    transformAnimation.toValue = NSNumber(double: 2.0)</div><div class="line">//  以上缩放是以view的中心点为中心缩放的，如果需要自定义缩放点，可以设置卯点：</div><div class="line">//        //中心点</div><div class="line">        animateView.layer.anchorPoint = CGPointMake(0.5, 0.5)</div><div class="line">//        //左上角</div><div class="line">        animateView.layer.anchorPoint = CGPointMake(0, 0)</div><div class="line">//        //右下角</div><div class="line">        animateView.layer.anchorPoint = CGPointMake(1.0, 1.0)</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   transform.rotation = 旋轉</div><div class="line">   transform.rotation.x</div><div class="line">   transform.rotation.y</div><div class="line">   transform.rotation.z</div><div class="line">   </div><div class="line">   &#123;</div><div class="line">    	 CABasicAnimation(keyPath: &quot;transform.rotation&quot;)</div><div class="line">    	 CABasicAnimation(keyPath: &quot;transform.rotation.x&quot;)</div><div class="line">    	 CABasicAnimation(keyPath: &quot;transform.rotation.y&quot;)</div><div class="line">    	 CABasicAnimation(keyPath: &quot;transform.rotation.z&quot;)</div><div class="line">    	 //初始角度</div><div class="line">        transformAnimation.fromValue = NSNumber(float: 0)</div><div class="line">        //旋转后角度</div><div class="line">        transformAnimation.toValue = NSNumber(float: 130)</div><div class="line">        </div><div class="line">        </div><div class="line">   &#125;</div><div class="line">   transform.translation</div><div class="line">   transform.translation.x</div><div class="line">   transform.translation.y</div><div class="line">   transform.translation.z</div><div class="line"></div><div class="line">   opacity = 透明度</div><div class="line">   margin</div><div class="line">   zPosition</div><div class="line">   backgroundColor 背景颜色</div><div class="line">   cornerRadius 圆角</div><div class="line">   borderWidth</div><div class="line">   bounds</div><div class="line">   contents</div><div class="line">   contentsRect</div><div class="line">   cornerRadius</div><div class="line">   frame</div><div class="line">   hidden</div><div class="line">   mask</div><div class="line">   masksToBounds</div><div class="line">   opacity</div><div class="line">   position</div><div class="line">   shadowColor</div><div class="line">   shadowOffset</div><div class="line">   shadowOpacity</div><div class="line">   shadowRadius</div><div class="line"></div><div class="line">   */</div></pre></td></tr></table></figure>
<h3 id="CABasicAnimation-组合动画"><a href="#CABasicAnimation-组合动画" class="headerlink" title="CABasicAnimation 组合动画"></a>CABasicAnimation 组合动画</h3><p>所有的动画都是由简单的简单的动画组合成的,所以对基础动画的学习是很重要的的,如果需要复杂的动画,当然是要发挥你的想象力啦~<br>自己按老师的代码敲了一遍,熟悉熟悉~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">//组合动画</div><div class="line">      func groupAnimation(theView:UIView)&#123;</div><div class="line"></div><div class="line">      //向右平移100</div><div class="line">      let mAnimation = CABasicAnimation(keyPath: &quot;position&quot;)</div><div class="line">      //baseAnimation.fromValue 初始位置，如果不设就是当前位置</div><div class="line">      let endPoint = CGPoint(x: theView.layer.position.x+100, y: theView.layer.position.y)</div><div class="line">      mAnimation.toValue = NSValue(CGPoint:endPoint)//绝对位置</div><div class="line"></div><div class="line">      //baseAnimation.byValue = NSValue(CGPoint:CGPoint(x: 100, y: 0))//相对位置</div><div class="line"></div><div class="line">      //x轴旋转动画</div><div class="line">      let xAnimation = CABasicAnimation(keyPath: &quot;transform.rotation.x&quot;)</div><div class="line">      (xAnimation as CABasicAnimation).byValue =  NSNumber(double:M_PI*500)</div><div class="line">      xAnimation.duration = 1.5</div><div class="line"></div><div class="line">      //y轴旋转动画</div><div class="line">      let yAnimation = CABasicAnimation(keyPath: &quot;transform.rotation.y&quot;)</div><div class="line">      (yAnimation as CABasicAnimation).byValue =  NSNumber(double:M_PI*200)</div><div class="line"></div><div class="line">      //缩放动画</div><div class="line">      let sAnimation = CABasicAnimation(keyPath: &quot;transform.scale&quot;)</div><div class="line">      // 动画选项设定</div><div class="line">      sAnimation.autoreverses = true // 动画结束时执行逆动画</div><div class="line">      // 缩放倍数</div><div class="line">      sAnimation.fromValue = NSNumber(double:0.1) // 开始时的倍率</div><div class="line">      sAnimation.toValue = NSNumber(double:1.5) // 结束时的倍率</div><div class="line"></div><div class="line">      //动画组</div><div class="line">      let groupAnimation = CAAnimationGroup()</div><div class="line"></div><div class="line">      // 动画选项设定，动画组统一设置或者单独设置</div><div class="line">      groupAnimation.duration = 3.0;</div><div class="line">      groupAnimation.repeatCount = 1;</div><div class="line">      groupAnimation.animations = [xAnimation,yAnimation,sAnimation,mAnimation]</div><div class="line">      //这两个属性若不设置，动画执行后回复位</div><div class="line">      groupAnimation.removedOnCompletion = false</div><div class="line">      groupAnimation.fillMode = kCAFillModeForwards</div><div class="line">      groupAnimation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionEaseIn)//加速运动</div><div class="line">      groupAnimation.delegate = self</div><div class="line">      //可以在动画中缓存一些</div><div class="line">      groupAnimation.setValue(NSValue(CGPoint: endPoint), forKey: &quot;endPoint&quot;)</div><div class="line">      groupAnimation.setValue(theView, forKey: &quot;sender&quot;)</div><div class="line">      //执行动画</div><div class="line">      theView.layer.addAnimation(groupAnimation, forKey: &quot;theViewMoveRotation90&quot;)</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p><img src="http://liuyanwei.jumppo.com/assets/uploads/animationAndEffect02.gif" alt=""></p>
<h3 id="关键帧动画-CAKeyframeAnimation"><a href="#关键帧动画-CAKeyframeAnimation" class="headerlink" title="关键帧动画 CAKeyframeAnimation"></a>关键帧动画 CAKeyframeAnimation</h3><blockquote>
<p>关键帧动画就是在动画控制过程中开发者指定主要的动画状态，至于各个状态间动画如何进行则由系统自动运算补充（每两个关键帧之间系统形成的动画称为“补间动画”），这种动画的好处就是开发者不用逐个控制每个动画帧，而只要关心几个关键帧的状态即可。</p>
</blockquote>
<p>那么,Keyframe顾名思义就是关键点的frame，你可以通过设定CALayer的始点、中间关键点、终点的frame，时间，动画会沿你设定的轨迹进行移动:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">private func KeyframeAnimation(theView:UIView)&#123;</div><div class="line">        </div><div class="line">        //关键帧动画</div><div class="line">        let keyframeAnimation = CAKeyframeAnimation(keyPath: &quot;position&quot;)</div><div class="line">        //弧线位置移动</div><div class="line">        </div><div class="line">        </div><div class="line">        //弧线位置移动</div><div class="line">        let path = CGPathCreateMutable()</div><div class="line">        CGPathMoveToPoint(path, nil, 50, 50)</div><div class="line">        //曲线描述</div><div class="line">        CGPathAddCurveToPoint(path, nil, 50, 50, 700, 300, 30, 500)</div><div class="line">        keyframeAnimation.path = path</div><div class="line">        </div><div class="line">        keyframeAnimation.duration = 1.0 ;</div><div class="line">        keyframeAnimation.beginTime =  CACurrentMediaTime() + 2;</div><div class="line">        theView.layer.addAnimation(keyframeAnimation, forKey: &quot;1111&quot;)</div><div class="line">        </div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><img src="http://liuyanwei.jumppo.com/assets/uploads/animationAndEffect03.gif" alt=""><br>(插图失败,为了让自己看到效果,继续借图)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">/**</div><div class="line">     先附带上让一些迷糊的属性解释吧,要不然大家好像有点看不懂!</div><div class="line">     （1）values属性</div><div class="line"></div><div class="line">     values属性指明整个动画过程中的关键帧点，例如上例中的A-E就是通过values指定的。需要注意的是，起点必须作为values的第一个值。</div><div class="line"></div><div class="line">     （2）path属性</div><div class="line"></div><div class="line">     作用与values属性一样，同样是用于指定整个动画所经过的路径的。需要注意的是，values与path是互斥的，当values与path同时指定时，path会覆盖values，即values属性将被忽略。例如上述pathAnimation例子</div><div class="line"></div><div class="line">     （3）keyTimes属性</div><div class="line"></div><div class="line">     该属性是一个数组，用以指定每个子路径(AB,BC,CD)的时间。如果你没有显式地对keyTimes进行设置，则系统会默认每条子路径的时间为：ti=duration/(5-1)，即每条子路径的duration相等，都为duration的1\4。当然，我们也可以传个数组让物体快慢结合。例如，你可以传入&#123;0.0, 0.1,0.6,0.7,1.0&#125;，其中首尾必须分别是0和1，因此tAB=0.1-0, tCB=0.6-0.1, tDC=0.7-0.6, tED=1-0.7.....</div><div class="line"></div><div class="line">     （4）timeFunctions属性</div><div class="line"></div><div class="line">     用过UIKit层动画的同学应该对这个属性不陌生，这个属性用以指定时间函数，类似于运动的加速度，有以下几种类型。上例子的AB段就是用了淡入淡出效果。记住，这是一个数组，你有几个子路径就应该传入几个元素</div><div class="line"></div><div class="line">     1 kCAMediaTimingFunctionLinear//线性</div><div class="line">     2 kCAMediaTimingFunctionEaseIn//淡入</div><div class="line">     3 kCAMediaTimingFunctionEaseOut//淡出</div><div class="line">     4 kCAMediaTimingFunctionEaseInEaseOut//淡入淡出</div><div class="line">     5 kCAMediaTimingFunctionDefault//默认</div><div class="line"></div><div class="line">     （5）calculationMode属性</div><div class="line"></div><div class="line">     该属性决定了物体在每个子路径下是跳着走还是匀速走，跟timeFunctions属性有点类似</div><div class="line"></div><div class="line">     1 const kCAAnimationLinear//线性，默认</div><div class="line">     2 const kCAAnimationDiscrete//离散，无中间过程，但keyTimes设置的时间依旧生效，物体跳跃地出现在各个关键帧上</div><div class="line">     3 const kCAAnimationPaced//平均，keyTimes跟timeFunctions失效</div><div class="line">     4 const kCAAnimationCubic//平均，同上</div><div class="line">     5 const kCAAnimationCubicPaced//平均，同上</div><div class="line"></div><div class="line">     */</div></pre></td></tr></table></figure>
<h3 id="转场效果"><a href="#转场效果" class="headerlink" title="转场效果"></a>转场效果</h3><p>转场动画的使用一般分为以下几个步骤：</p>
<ul>
<li>创建转场动画</li>
<li>设置转场类型、子类型（可选）及其他属性</li>
<li>设置转场后的新视图并添加动画到图层</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line">  //步骤1：添加view底图，添加view的左右滑动手势</div><div class="line">    let bg = UIImageView(image: UIImage(named: &quot;x0&quot;))</div><div class="line">    func addBgImageView()&#123;</div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">        bg.frame = CGRect(x: 0, y: 0, width: UIScreen.mainScreen().bounds.size.width, height: UIScreen.mainScreen().bounds.size.height)</div><div class="line">        view.addSubview(bg)</div><div class="line">        </div><div class="line">        let rightSwipe = UISwipeGestureRecognizer(target: self, action:#selector(ViewController.rightSwipe(_:)))</div><div class="line">        rightSwipe.direction = .Right</div><div class="line">        let leftSwipe = UISwipeGestureRecognizer(target: self, action: #selector(ViewController.leftSwipe(_:)))</div><div class="line">        leftSwipe.direction = .Left</div><div class="line">        </div><div class="line">        view.addGestureRecognizer(rightSwipe)</div><div class="line">        view.addGestureRecognizer(leftSwipe)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">//    步骤2：随机获取图片和随机获取转场效果的函数</div><div class="line">    var images:[UIImage]?</div><div class="line">    func fetchImage()-&gt;UIImage&#123;</div><div class="line">        if images == nil &#123;</div><div class="line">            images = [];</div><div class="line">            </div><div class="line">            for index in 0...5 &#123;</div><div class="line">                let image = UIImage(named: &quot;x&quot; + String(index))</div><div class="line">                images!.append(image!)</div><div class="line">                </div><div class="line">            &#125;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        return images![Int(arc4random()%5)]</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    func swipeTransition(subtype:String) -&gt; CATransition &#123;</div><div class="line">        let transfer = CATransition()</div><div class="line">        </div><div class="line">        /*</div><div class="line">         kCATransitionFade：淡入淡出，默认效果</div><div class="line">         kCATransitionMoveIn：新视图移动到就是图上方</div><div class="line">         kCATransitionPush:新视图推开旧视图</div><div class="line">         kCATransitionReveal：移走旧视图然后显示新视图</div><div class="line">         </div><div class="line">         //苹果未公开的私有转场效果</div><div class="line">         cube:立方体</div><div class="line">         suckEffect:吸走的效果</div><div class="line">         oglFlip:前后翻转效果</div><div class="line">         rippleEffect:波纹效果</div><div class="line">         pageCurl:翻页起来</div><div class="line">         pageUnCurl:翻页下来</div><div class="line">         cameraIrisHollowOpen:镜头开</div><div class="line">         cameraIrisHollowClose:镜头关</div><div class="line">         */</div><div class="line">        </div><div class="line">        let types = [kCATransitionFade,kCATransitionMoveIn,kCATransitionPush,kCATransitionReveal,&quot;cube&quot;,&quot;suckEffect&quot;,&quot;oglFlip&quot;,&quot;rippleEffect&quot;,&quot;pageCurl&quot;,&quot;pageUnCurl&quot;,&quot;cameraIrisHollowOpen&quot;,&quot;cameraIrisHollowClose&quot;]</div><div class="line">        </div><div class="line">        let type = types[Int(arc4random()%11)]</div><div class="line">        </div><div class="line">        transfer.type = type</div><div class="line">        </div><div class="line">        NSLog(&quot;%@&quot;, type)</div><div class="line">        </div><div class="line">        transfer.subtype = subtype</div><div class="line">        transfer.duration = 1</div><div class="line">        return transfer</div><div class="line">    &#125;</div><div class="line">//    步骤3：左右滑动方法，实现场景切换</div><div class="line">    </div><div class="line">    func rightSwipe(rightSwipe:UIGestureRecognizer)&#123;</div><div class="line">        </div><div class="line">        bg.image = fetchImage()</div><div class="line">        bg.layer.addAnimation(swipeTransition(kCATransitionFromRight), forKey: &quot;kCATransitionFromRight&quot;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    func leftSwipe(leftSwipe:UIGestureRecognizer)&#123;</div><div class="line">        </div><div class="line">        bg.image = fetchImage()</div><div class="line">        bg.layer.addAnimation(swipeTransition(kCATransitionFromLeft), forKey: &quot;kCATransitionFromleft&quot;)</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><img src="http://liuyanwei.jumppo.com/assets/uploads/animationAndEffect04.gif" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/28/swift中的跑马灯实现（导航栏）/" itemprop="url">
                  swift中的跑马灯实现（导航栏）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-28T03:28:57+08:00" content="2016-03-28">
              2016-03-28
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>首先是懒加载了runLabel：</p>
<pre><code> private lazy var runLabel : UILabel={
     let label = UILabel()
     label.sizeToFit()

    label.font = UIFont(name: kMyFontName, size: kFontSize14)
    label.textColor = UIColor.blackColor()
    return label
}()
</code></pre><p>然后在viewDidLoad中实现addsubView方法：</p>
<pre><code>/// 跑马灯
self.navigationItem.titleView?.addSubview(runLabel)
//设置label的原始位置
runLabel.frame.origin.x = kScreenWidth


UIView.beginAnimations(self.productName, context: nil)
UIView.setAnimationDuration(16)
UIView.setAnimationCurve(UIViewAnimationCurve.Linear)
UIView.setAnimationDelegate(self)
UIView.setAnimationRepeatCount(999999)

runLabel.frame.origin.x = -runLabel.frame.size.width
UIView .commitAnimations()
</code></pre><p>另外如果文字过长的话建议直接计算文字宽度（做个简单的分类即可）</p>
<pre><code>extension String {
  func getTitleW() -&gt; CGFloat{
     /// 计算文字宽度
     var dict:[String:AnyObject] = [:]
      dict[NSFontAttributeName] = UIFont(name: kMyFontName, size:   kFontSize14)
          return NSString(string:     self).boundingRectWithSize(CGSizeMake(999, 14), options: NSStringDrawingOptions.UsesLineFragmentOrigin, attributes: dict, context: nil).size.width + 24

    }
}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/12/第三方HTML解析-TFHpple-的简单使用/" itemprop="url">
                  第三方HTML解析 TFHpple 的简单使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-12T16:42:32+08:00" content="2016-03-12">
              2016-03-12
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="第三方HTML解析-TFHpple-的简单使用-swift版"><a href="#第三方HTML解析-TFHpple-的简单使用-swift版" class="headerlink" title="第三方HTML解析 TFHpple 的简单使用(swift版)"></a>第三方HTML解析 TFHpple 的简单使用(swift版)</h3><h3 id="一-使用TFHpple解析-必须导入文件和框架xmllib2"><a href="#一-使用TFHpple解析-必须导入文件和框架xmllib2" class="headerlink" title="一.使用TFHpple解析,必须导入文件和框架xmllib2"></a>一.使用TFHpple解析,必须导入文件和框架xmllib2</h3><p>(OS_导入libxml2.2框架后,找不到<libxml tree.h="">的解决办法)</libxml></p>
<ol>
<li><p>pod导入TFHpple第三方库(<strong>此时编译会报错误:找不到libxml tree.h</strong>)</p>
</li>
<li><p>下载完成后需要配置项目中的动态库,选中项目,像工程中添加”libxml2.tbd” (借一下图,感谢<a href="http://my.csdn.net/pilqc2009" target="_blank" rel="external">pilqc2009</a>)<br><img src="http://img.blog.csdn.net/20140822203855390?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="1"></p>
</li>
</ol>
<p><img src="../../images/1.png" alt=""></p>
<ol>
<li><p>切换到切换到Buiild Settings的tab里，通过搜索,找到“Linking”选项框，在里面的”Other Linker Flags”的debug 和 release 里面点击“+”，添加 “-lxml2”<br><img src="http://img.blog.csdn.net/20140822204223171?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
</li>
<li><p>跟步骤2一样，依然在Buiild Settings的tab里，通过搜索，找到 Framework Search ,添加“/usr/lib/libxml2.tbd”；<br><img src="http://img.blog.csdn.net/20140822204710075?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
</li>
</ol>
<ol>
<li>跟步骤3一样，依然在Buiild Settings的tab里，通过搜索，在“Header Search Paths” 和 “User Header Search Paths” 里填入$(SDKROOT)/usr/include/libxml2。<br><img src="http://img.blog.csdn.net/20140822205006387?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcHJlX2VtaW5lbnQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></li>
</ol>
<ol>
<li>然后clean项目，就OK，可以使用了。</li>
</ol>
<h3 id="二-那么-导入以后又应该如何使用TFHpple呢"><a href="#二-那么-导入以后又应该如何使用TFHpple呢" class="headerlink" title="二.那么,导入以后又应该如何使用TFHpple呢?"></a>二.那么,导入以后又应该如何使用TFHpple呢?</h3><p>我们先来看看官方在oc下是如何使用的吧:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#import &quot;TFHpple.h&quot;</div><div class="line"></div><div class="line">//</div><div class="line">NSData  * data      = [NSData dataWithContentsOfFile:@&quot;index.html&quot;];</div><div class="line"></div><div class="line">//</div><div class="line">TFHpple * doc       = [[TFHpple alloc] initWithHTMLData:data];</div><div class="line">NSArray * elements  = [doc search:@&quot;//a[@class=&apos;sponsor&apos;]&quot;];</div><div class="line"></div><div class="line">TFHppleElement * element = [elements objectAtIndex:0];</div><div class="line">[e text];                       // The text inside the HTML element (the content of the first text node)</div><div class="line">[e tagName];                    // &quot;a&quot;</div><div class="line">[e attributes];                 // NSDictionary of href, class, id, etc.</div><div class="line">[e objectForKey:@&quot;href&quot;];       // Easy access to single attribute</div><div class="line">[e firstChildWithTagName:@&quot;b&quot;]; // The first &quot;b&quot; child node</div></pre></td></tr></table></figure>
<h4 id="2-1分析一下它是如何使用该类的"><a href="#2-1分析一下它是如何使用该类的" class="headerlink" title="2.1分析一下它是如何使用该类的:"></a>2.1分析一下它是如何使用该类的:</h4><ul>
<li>第一步先将.html转为为data文件</li>
<li>第二步是用带data参数的方法实例化TFHpple对象</li>
<li>第三步的时候,我们就可以用各种适配的方法来进行节点的获取了(<strong>下面会讲到这些条件是怎么使用的</strong>)</li>
<li>第四步,获取到某个节点的时候,如果确定只有一个用该类命名的元素时,可以直接取first第一个元素<ul>
<li>text是该元素下,dom中间的内容</li>
<li>tagName 是该元素的html标签</li>
<li>attributes 是该元素下,元素属性的值</li>
<li>objectForKey:@”href” 可以根据节点属性来取属性中属性的值,如取imageUrl</li>
<li>firstChildWithTagName:@”b”  第一个名称为b的子节点</li>
</ul>
</li>
</ul>
<p>其实掌握了以上的方法,就可以很好的运用该框架来获取html文件中的任何内容了. </p>
<h4 id="2-2这里先来解释一下-TFHpple中的类方法seacrh-quot-xxxxx-quot-是什么东西吧"><a href="#2-2这里先来解释一下-TFHpple中的类方法seacrh-quot-xxxxx-quot-是什么东西吧" class="headerlink" title="2.2这里先来解释一下 TFHpple中的类方法seacrh:&quot;xxxxx&quot;是什么东西吧!"></a>2.2这里先来解释一下 TFHpple中的类方法<code>seacrh:&quot;xxxxx&quot;</code>是什么东西吧!</h4><p><strong>其实这个就是一个选取节点的武器,让给我们来看看这部分是怎么组成的吧(有html基础的同学可能能更快反应过来)</strong></p>
<p>XPath 使用路径表达式在 XML 文档中选取节点。节点是通过沿着路径或者 step 来选取</p>
<p><strong>下面列出了最有用的路径表达式：</strong></p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td> /</td>
<td>从根节点选取。</td>
</tr>
<tr>
<td> //</td>
<td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</td>
</tr>
<tr>
<td> .</td>
<td>选取当前节点。</td>
</tr>
<tr>
<td> ..</td>
<td>选取当前节点的父节点。</td>
</tr>
<tr>
<td> @</td>
<td>选取属性。</td>
</tr>
</tbody>
</table>
<p>举个例子来体会一下吧,下面是xml文档格式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</div><div class="line"></div><div class="line">&lt;bookstore&gt;</div><div class="line"></div><div class="line">&lt;book&gt;</div><div class="line">  &lt;title lang=&quot;eng&quot;&gt;Harry Potter&lt;/title&gt;</div><div class="line">  &lt;price&gt;29.99&lt;/price&gt;</div><div class="line">&lt;/book&gt;</div><div class="line"></div><div class="line">&lt;book&gt;</div><div class="line">  &lt;title lang=&quot;eng&quot;&gt;Learning XML&lt;/title&gt;</div><div class="line">  &lt;price&gt;39.95&lt;/price&gt;</div><div class="line">&lt;/book&gt;</div><div class="line"></div><div class="line">&lt;/bookstore&gt;</div></pre></td></tr></table></figure>
<p><strong>在下面的表格中，我们已列出了一些路径表达式以及表达式的结果：</strong></p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>bookstore</td>
<td>选取 bookstore 元素的所有子节点。</td>
</tr>
<tr>
<td>/bookstore</td>
<td>选取根元素 bookstore。注释：假如路径起始于正斜杠( / )，则此路径始终代表到某元素的绝对路径！</td>
</tr>
<tr>
<td>bookstore/book</td>
<td>选取属于 bookstore 的子元素的所有 book 元素。</td>
</tr>
<tr>
<td>//book</td>
<td>选取所有 book 子元素，而不管它们在文档中的位置。</td>
</tr>
<tr>
<td>bookstore//book</td>
<td>选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</td>
</tr>
<tr>
<td>//@lang</td>
<td>选取名为 lang 的所有属性。</td>
</tr>
</tbody>
</table>
<h5 id="谓语（Predicates）"><a href="#谓语（Predicates）" class="headerlink" title="谓语（Predicates）"></a>谓语（Predicates）</h5><p>谓语用来查找某个特定的节点或者包含某个指定的值的节点。<br>谓语被嵌在方括号中。</p>
<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h5><p>在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>/bookstore/book[1]</td>
<td>选取属于 bookstore 子元素的第一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()]</td>
<td>选取属于 bookstore 子元素的最后一个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[last()-1]</td>
<td>选取属于 bookstore 子元素的倒数第二个 book 元素。</td>
</tr>
<tr>
<td>/bookstore/book[position()&lt;3]</td>
<td>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</td>
</tr>
<tr>
<td>//title[@lang]</td>
<td>选取所有拥有名为 lang 的属性的 title 元素。</td>
</tr>
<tr>
<td>//title[@lang=’eng’</td>
<td>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00</td>
<td>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
<tr>
<td>/bookstore/book[price&gt;35.00]/title</td>
<td>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</td>
</tr>
</tbody>
</table>
<h5 id="选取未知节点"><a href="#选取未知节点" class="headerlink" title="选取未知节点"></a>选取未知节点</h5><p>XPath 通配符可用来选取未知的 XML 元素。</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>匹配任何元素节点。</td>
</tr>
<tr>
<td>@*</td>
<td>匹配任何属性节点。</td>
</tr>
<tr>
<td>node()</td>
<td>匹配任何类型的节点。</td>
</tr>
</tbody>
</table>
<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h5><p>在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>/bookstore/*</td>
<td>选取 bookstore 元素的所有子元素。</td>
</tr>
<tr>
<td>//*</td>
<td>选取文档中的所有元素。</td>
</tr>
<tr>
<td>//title[@*]</td>
<td>选取所有带有属性的 title 元素。</td>
</tr>
</tbody>
</table>
<h5 id="选取若干路径"><a href="#选取若干路径" class="headerlink" title="选取若干路径"></a>选取若干路径</h5><p>通过在路径表达式中使用“|”运算符，您可以选取若干个路径。</p>
<h5 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h5><p>在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>//book/title</td>
<td>//book/price    选取 book 元素的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>//title</td>
<td>//price    选取文档中的所有 title 和 price 元素。</td>
</tr>
<tr>
<td>/bookstore/book/title</td>
<td>//price    选取属于 bookstore 元素的 book 元素的所有 title 元素，以及文档中所有的 price 元素。</td>
</tr>
</tbody>
</table>
<p>(以上关于节点的内容,转载自<a href="http://blog.csdn.net/ministarler/article/details/17561641" target="_blank" rel="external">Ministarler</a>,如有侵权请告知,本人将立刻删除)</p>
<h4 id="2-3-其实这个框架的使用非常简答-你要弄清楚的就是了解下面几个到底是意思"><a href="#2-3-其实这个框架的使用非常简答-你要弄清楚的就是了解下面几个到底是意思" class="headerlink" title="2.3 其实这个框架的使用非常简答,你要弄清楚的就是了解下面几个到底是意思:"></a>2.3 其实这个框架的使用非常简答,你要弄清楚的就是了解下面几个到底是意思:</h4><ul>
<li><strong>节点</strong></li>
<li><strong>节点属性</strong></li>
<li><strong>节点属性值</strong></li>
<li><strong>节点的内容</strong></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/12/swift-中异常处理do-catch的简单理解/" itemprop="url">
                  swift 中异常处理do...catch的简单理解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-12T13:19:47+08:00" content="2016-03-12">
              2016-03-12
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-使用枚举来设置错误值是很好的办法"><a href="#1-使用枚举来设置错误值是很好的办法" class="headerlink" title="1. 使用枚举来设置错误值是很好的办法"></a>1. 使用枚举来设置错误值是很好的办法</h4><p>使用如下办法来创建异常类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">enum NetWorkingError:Error &#123;</div><div class="line">    case NilString</div><div class="line">    case WithoutUrl</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2-怎么去抛出异常"><a href="#2-怎么去抛出异常" class="headerlink" title="2. 怎么去抛出异常"></a>2. 怎么去抛出异常</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func getString(Str:String?) throws -&gt;String</div></pre></td></tr></table></figure>
<p>聪明的你,肯定一眼就能看明白,只想要在返回值前面写一个throws关键字就可以定义异常抛出了,其实感觉有点象以后oc中带一个error的参数.不过在swift中含有error的api几乎都改成了异常抛出了.<br>那么,如何使用呢?</p>
<p>我们只需在调用方法的时候使用do…catch就可以了:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">do &#123;</div><div class="line">			//如果无法处理该方法,则直接跳去catch里面</div><div class="line">         let s = try getString(Str: nil)</div><div class="line">         print(s)</div><div class="line">     &#125; catch &#123;</div><div class="line">         print(&quot;错误处理&quot;)</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
<p>如果你觉得你已经做好了处理,肯定不会产生异常信息,可以使用<code>try!</code>,这种方法去解析,但一般不建议这样使用</p>
<pre><code>let str = try! getString(Str:&quot;abc&quot;)
</code></pre><h4 id="3-如果写入一个异常"><a href="#3-如果写入一个异常" class="headerlink" title="3. 如果写入一个异常?"></a>3. 如果写入一个异常?</h4><p>我们还没有说到异常是怎么抛出的,作为一种新的语言,swift还提供了优雅的方式来处理异常:<code>guard</code>,如果换成用语言来描述的话:条件成立的时候跳过else里面处理方式,所以有下面的写法:</p>
<pre><code>func getString(Str:String?) throws -&gt;String{

    guard let str = Str else {
        throw NetWorkingError.NilString
    }
    return &quot;........\(str)&quot;
}
</code></pre><p>这个时候就可以定义了异常的抛出了,swift也支持了 Pattern Matching 功能,是不是很像Java中的抛出?</p>
<p>所以,在代码中我们可以再作处理:</p>
<pre><code> func getString(Str:String?,Url:String?) throws -&gt;String{

    guard let str = Str else {
    //抛出一个异常
        throw NetWorkingError.NilString
    }

    guard let str = Url else {
    //抛出第二个异常
        throw NetWorkingError.WithoutUrl
    }

    return &quot;........\(str)&quot;
}
</code></pre><p>那么,我们在使用的时候就可以对异常进行二次捕抓:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">do &#123;</div><div class="line">    try functionWillThrowError()</div><div class="line">    //</div><div class="line">  &#125; catch NetWorkingError.NilString &#123;</div><div class="line">    // deal with not exist</div><div class="line">  &#125; catch NetWorkingError.WithoutUrl &#123;</div><div class="line">    // deal with not exist</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h4 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结:"></a>4. 总结:</h4><ul>
<li>使用 ErrorType 的帮助建立你的异常类型</li>
<li>使用 throws 来声明异常，用 throw 来抛出异常</li>
<li>使用 do-catch 机制来获取和处理异常</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/07/ReactiveCocoa在swift情况下使用宏/" itemprop="url">
                  ReactiveCocoa在swift情况下使用宏
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-07T10:19:17+08:00" content="2016-03-07">
              2016-03-07
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="在swift的环境下-配置RAC和RACObserve宏需要另外添加文件-如下"><a href="#在swift的环境下-配置RAC和RACObserve宏需要另外添加文件-如下" class="headerlink" title="在swift的环境下,配置RAC和RACObserve宏需要另外添加文件,如下:"></a>在swift的环境下,配置RAC和RACObserve宏需要另外添加文件,如下:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">import ReactiveCocoa</div><div class="line">public struct RAC  &#123;</div><div class="line">        var target : NSObject!</div><div class="line">        var keyPath : String!</div><div class="line">    var nilValue : AnyObject!</div><div class="line"></div><div class="line">    init(_ target: NSObject!, _ keyPath: String, nilValue: AnyObject? = nil) &#123;</div><div class="line">        self.target = target</div><div class="line">        self.keyPath = keyPath</div><div class="line">        self.nilValue = nilValue</div><div class="line">     &#125;</div><div class="line"></div><div class="line">    func assignSignal(signal : RACSignal) &#123;</div><div class="line">        signal.setKeyPath(self.keyPath, onObject: self.target, nilValue: self.nilValue)</div><div class="line">      &#125;</div><div class="line"> &#125;</div><div class="line"></div><div class="line">public func RACObserve(target: NSObject!, keyPath: NSString) -&gt; RACSignal  &#123;</div><div class="line">       return target.rac_valuesForKeyPath(keyPath as String, observer: target)</div><div class="line">&#125;</div><div class="line"></div><div class="line">public func &lt;= (rac:RAC, signal:RACSignal)&#123;</div><div class="line">       rac.assignSignal(signal)</div><div class="line">&#125; </div><div class="line"></div><div class="line">public func &gt;=( signal:RACSignal, rac:RAC)&#123;</div><div class="line">     rac.assignSignal(signal)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在学习swift导入RAC的过程中,由于宏在OC项目中非常好用,但是宏在swift中不好使,需要额外导入文件才能正常使用.<br>下面举了一个textFiled输入文字时,改变下面的那个label内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">  import UIKit</div><div class="line">  import SnapKit</div><div class="line">  import ReactiveCocoa</div><div class="line">  //import ReactiveCocoa.RACEXTScope</div><div class="line"></div><div class="line">  func == (Str1:String,Str:String) -&gt;Bool&#123;      </div><div class="line">      return true</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  class ViewController: UIViewController &#123;</div><div class="line"></div><div class="line">    </div><div class="line">    override func viewDidLoad() &#123;</div><div class="line">        super.viewDidLoad()</div><div class="line">        view.addSubview(textFiled)</div><div class="line">        view.addSubview(label)</div><div class="line">        </div><div class="line">        textFiled.snp_makeConstraints &#123; (make) in</div><div class="line">            make.center.equalTo(self.view)</div><div class="line">            make.width.equalTo(100)</div><div class="line">            make.height.equalTo(30)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        label.snp_makeConstraints &#123; (make) in</div><div class="line">            make.top.equalTo(textFiled).offset(20)</div><div class="line">            make.centerX.equalTo(textFiled)</div><div class="line">            make.width.equalTo(100)</div><div class="line">            make.height.equalTo(30)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        let str1 = &quot;1&quot;</div><div class="line">        let str2 = &quot;2&quot;</div><div class="line">        let bool = str1==str2</div><div class="line">        print(bool)</div><div class="line">        RAC(label,&quot;text&quot;) &lt;= textFiled.rac_textSignal()</div><div class="line"> </div><div class="line">  </div><div class="line"></div><div class="line">    RACObserve(label, keyPath: &quot;center&quot;) .subscribeNext &#123; (x) in</div><div class="line">            print(&quot;移动的距离为:\(x)&quot; </div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override func touchesBegan(touches: Set&lt;UITouch&gt;, withEvent event: UIEvent?) &#123;</div><div class="line">  //点击屏幕label向下移动</div><div class="line">        label.snp_remakeConstraints &#123; (make) in</div><div class="line">            make.top.equalTo(textFiled).offset( number * 20)</div><div class="line">            make.centerX.equalTo(textFiled)</div><div class="line">            make.width.equalTo(100)</div><div class="line">            make.height.equalTo(30)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        number += 1</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private lazy var textFiled : UITextField=&#123;</div><div class="line">        let textFiled = UITextField()</div><div class="line">        textFiled.placeholder = &quot;请输入文字&quot;</div><div class="line">        return textFiled</div><div class="line">    &#125;()</div><div class="line"></div><div class="line">    private lazy var label : UILabel=&#123;</div><div class="line">        let label = UILabel()</div><div class="line">        label.text = &quot;我是占位文字,textFiled改变时我也会改变&quot;</div><div class="line">        label.font = UIFont.systemFontOfSize(16)</div><div class="line">        </div><div class="line">        return label</div><div class="line">      &#125;()</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>其中textFiled绑定label的核心代码就是:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 只要文本框文字改变，就会修改label的文字</div><div class="line">RAC(label,&quot;text&quot;) &lt;= textFiled.rac_textSignal()</div></pre></td></tr></table></figure>
<p>一句话就可以实现绑定textFiled变化时,label也跟着变化</p>
<ul>
<li>其中点击屏幕label往下移动的核心代码是:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">        RACObserve(label, keyPath:&quot;center&quot;) .subscribeNext &#123; (x) in</div><div class="line">            print(&quot;移动的距离为:\(x)&quot; </div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>RACObserve宏代码会让其返回一个Signal,我们使用订阅的时候,即可像KVO一样绑定信息,监控对象某个属性的变化.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/13/Swift中-enum和Switch的应用/" itemprop="url">
                  Swift中 enum和Switch的应用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-13T23:27:15+08:00" content="2016-02-13">
              2016-02-13
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###好处<br>其实在很多菜鸟中会忽视了枚举的好处,使用枚举最显而易见的好处是能让代码更加清晰,应用得最多的地方是选项在超过两项或两项以上的时候能让协同开发的小伙伴更加清晰.</p>
<p>###例子<br>我新建了一个dome,里面创建了一个计算器calculatorControl的类,而在它里面又定义了一个calculatroEnum的枚举,此时枚举让整个语义更加清晰.但让我觉得比较有兴趣的是在加减乘除以后,我还定义了一个求勾股定理斜边的powerWihtNum(Double),和其他枚举不同的是这个枚举可以接受一个开多少次方的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">enum calculatorEnum &#123;</div><div class="line">    case add</div><div class="line">    case sub</div><div class="line">    case div</div><div class="line">    case mul</div><div class="line">    case powerWihtNum(Double)</div><div class="line">    private func calculatorForResult(x:Double,y:Double)-&gt;Double?&#123;</div><div class="line">        switch self &#123;</div><div class="line">        case .add:</div><div class="line">            return x + y;</div><div class="line">        case .sub:</div><div class="line">            return x - y;</div><div class="line">        case .div:</div><div class="line">            return x / y;</div><div class="line">        case .mul:</div><div class="line">            return x * y;</div><div class="line">        case .powerWihtNum(let i):</div><div class="line">            return pow(x, i) + pow(y, i);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class CalculatorControl: NSObject &#123;</div><div class="line"></div><div class="line">    convenience  init(x:Double,y:Double,n:Double?,WihtPath path:calculatorEnum) &#123;</div><div class="line">        self.init();</div><div class="line">        </div><div class="line">        print(&quot;输出的结果是\(path.calculatorForResult(x, y: y))&quot;);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">```   </div><div class="line"></div><div class="line">如果在控制中调用该类,则能打印出相应的值.</div></pre></td></tr></table></figure>
<p>   override func viewDidLoad() {<br>        super.viewDidLoad()<br>        CalculatorControl.init(x: 3, y: 4, n: nil, WihtPath: calculatorEnum.powerWihtNum(2))<br>    }<br>//打印台输出:输出的结果是<em>**</em>Optional(25.0)</p>
<p>```</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/28/（UIVibrancyEffect、-UIBlurEffect（毛玻片效果））/" itemprop="url">
                  （UIVibrancyEffect、 UIBlurEffect（毛玻片效果））
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-28T17:58:29+08:00" content="2016-01-28">
              2016-01-28
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在iOS 8后，苹果开放了不少创建特效的接口，其中就包括创建毛玻璃(blur)的接口。</p>
<p>通常要想创建一个特殊效果(如blur效果)，可以创建一个<strong>UIVisualEffectView</strong>视图对象，这个对象提供了一种简单的方式来实现复杂的视觉效果。这个可以把这个对象看作是效果的一个容器，实际的效果会影响到该视图对象底下的内容，或者是添加到该视图对象的<strong>contentVie</strong>w中的内容。</p>
<p>我们举个例子来看看如果使用UIVisualEffectView：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let bgView: UIImageView = UIImageView(image: UIImage(named: &quot;visual&quot;))</div><div class="line">bgView.frame = self.view.bounds</div><div class="line">self.view.addSubview(bgView)</div><div class="line">let blurEffect: UIBlurEffect = UIBlurEffect(style: .Light)</div><div class="line">let blurView: UIVisualEffectView = UIVisualEffectView(effect: blurEffect)</div><div class="line">blurView.frame = CGRectMake(50.0, 50.0, self.view.frame.width - 100.0, 200.0)</div><div class="line">self.view.addSubview(blurView)</div></pre></td></tr></table></figure>
<p>这段代码是在当前视图控制器上添加了一个UIImageView作为背景图。然后在视图的一小部分中使用了blur效果。</p>
<p>我们可以看到<strong>UIVisualEffectView</strong>还是非常简单的。需要注意是的，不应该直接添加子视图到<strong>UIVisualEffectView</strong>视图中，而是应该添加到<strong>UIVisualEffectView</strong>对象的contentView中。</p>
<p>另外，尽量避免将UIVisualEffectView对象的alpha值设置为小于1.0的值，因为创建半透明的视图会导致系统在离屏渲染时去对UIVisualEffectView对象及所有的相关的子视图做混合操作。这不但消耗CPU/GPU，也可能会导致许多效果显示不正确或者根本不显示。</p>
<p>我们在上面看到，初始化一个UIVisualEffectView对象的方法是<code>UIVisualEffectView(effect: blurEffect)</code>，其定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">init(effect effect: UIVisualEffect)</div></pre></td></tr></table></figure>
<p>这个方法的参数是一个UIVisualEffect对象。我们查看官方文档，可以看到在UIKit中，定义了几个专门用来创建视觉特效的，它们分别是UIVisualEffect、UIBlurEffect和UIVibrancyEffect。它们的继承层次如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">NSObject</div><div class="line">| -- UIVisualEffect</div><div class="line">    | -- UIBlurEffect</div><div class="line">    | -- UIVibrancyEffect</div></pre></td></tr></table></figure>
<p>UIVisualEffect是一个继承自NSObject的创建视觉效果的基类，然而这个类除了继承自NSObject的属性和方法外，没有提供任何新的属性和方法。其主要目的是用于初始化UIVisualEffectView，在这个初始化方法中可以传入UIBlurEffect或者UIVibrancyEffect对象。</p>
<p>一个UIBlurEffect对象用于将blur(毛玻璃)效果应用于UIVisualEffectView视图下面的内容。如上面的示例所示。不过，这个对象的效果并不影响UIVisualEffectView对象的contentView中的内容。</p>
<p>UIBlurEffect主要定义了三种效果，这些效果由枚举UIBlurEffectStyle来确定，该枚举的定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">enum UIBlurEffectStyle : Int &#123;</div><div class="line">    case ExtraLight</div><div class="line">    case Light</div><div class="line">    case Dark</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其主要是根据色调(hue)来确定特效视图与底部视图的混合。</p>
<p>与UIBlurEffect不同的是，UIVibrancyEffect主要用于放大和调整UIVisualEffectView视图下面的内容的颜色，同时让UIVisualEffectView的contentView中的内容看起来更加生动。通常UIVibrancyEffect对象是与UIBlurEffect一起使用，主要用于处理在UIBlurEffect特效上的一些显示效果。接上面的代码，我们看看在blur的视图上添加一些新的特效，如下代码所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let vibrancyView: UIVisualEffectView = UIVisualEffectView(effect: UIVibrancyEffect(forBlurEffect: blurEffect))</div><div class="line">vibrancyView.setTranslatesAutoresizingMaskIntoConstraints(false)</div><div class="line">blurView.contentView.addSubview(vibrancyView)</div><div class="line">var label: UILabel = UILabel()</div><div class="line">label.setTranslatesAutoresizingMaskIntoConstraints(false)</div><div class="line">label.text = &quot;Vibrancy Effect&quot;</div><div class="line">label.font = UIFont(name: &quot;HelveticaNeue-Bold&quot;, size: 30)</div><div class="line">label.textAlignment = .Center</div><div class="line">label.textColor = UIColor.whiteColor()</div><div class="line">vibrancyView.contentView.addSubview(label)</div></pre></td></tr></table></figure>
<p>vibrancy特效是取决于颜色值的。所有添加到contentView的子视图都必须实现tintColorDidChange方法并更新自己。需要注意的是，我们使用<code>UIVibrancyEffect(forBlurEffect:)</code>方法创建UIVibrancyEffect时，参数blurEffect必须是我们想加效果的那个blurEffect，否则可能不是我们想要的效果。</p>
<p>另外，UIVibrancyEffect还提供了一个类方法<code>notificationCenterVibrancyEffect</code>，其声明如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class func notificationCenterVibrancyEffect() -&gt; UIVibrancyEffect!</div></pre></td></tr></table></figure>
<p>这个方法创建一个用于通知中心的Today扩展的vibrancy特效。</p>
<p><strong>本文为过去学习的时候留下来的笔记,现在已经找不到原文出处,如果发现,请联系303661702</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/19/放肆的使用UIBezierPath和CAShapeLayer画各种图形/" itemprop="url">
                  放肆的使用UIBezierPath和CAShapeLayer画各种图形
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-19T14:51:31+08:00" content="2016-01-19">
              2016-01-19
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文转自<a href="http://www.jianshu.com/p/c5cbb5e05075" target="_blank" rel="external">放肆的使用UIBezierPath和CAShapeLayer画各种图形</a>,有需要的同学直接到原文查看,本文仅为个人学习记录所用~!</p>
<p>CAShapeLayer 是 CALayer 的子类，但是比 CALayer 更灵活，可以画出各种图形，当然，你也可以使用其他方式来画，随你。其实我还想说,基本上CAShapeLayer和UIBezierPath已经可以虐杀大部分的画了.</p>
<h3 id="杂谈"><a href="#杂谈" class="headerlink" title="杂谈"></a>杂谈</h3><p>在 CAShapeLayer 中，也可以像 CALayer 一样指定它的 frame 来画，就像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let layer = CAShapeLayer()</div><div class="line">layer.frame = CGRectMake(110, 100, 150, 100)</div><div class="line">layer.backgroundColor = UIColor.blackColor().CGColor</div><div class="line"></div><div class="line">view.layer.addSublayer(layer)</div></pre></td></tr></table></figure>
<p>然后你就会得到如图这样的黑色矩形,如下图所示:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-cabed9c2ad73957b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt=""></p>
<p>但是，CAShapeLayer 有一个神奇的属性 <code>path</code> 用这个属性配合上 UIBezierPath 这个类就可以达到超神的效果。</p>
<p>UIBezierPath 顾名思义，这是用贝塞尔曲线的方式来构建一段弧线，你可以用任意条弧线来组成你想要的形状，比如，你想用它来和上面一样画一个矩形，那就可以这样子来做：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let path = UIBezierPath(rect: CGRectMake(110, 100, 150, 100))</div><div class="line">let layer = CAShapeLayer()</div><div class="line">layer.path = path.CGPath</div><div class="line">layer.fillColor = UIColor.blackColor().CGColor</div><div class="line">view.layer.addSublayer(layer)</div></pre></td></tr></table></figure>
<p>要注意的是，这里就不要用backgroundColor 这个属性了，而要使用 <code>fillColor</code> 和 <code>strokeColor</code> ，前者代表设置这个 Layer 的填充色，后者代表设置它的边框色:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">layer.fillColor = UIColor.clearColor().CGColor</div><div class="line">layer.strokeColor = UIColor.blackColor().CGColor</div></pre></td></tr></table></figure>
<p>可以试一下把上面代码设置颜色的部分改成这个样子，那么运行程序的时候就会是这种样子:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-c62af1131985de8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt=""></p>
<h3 id="玩一下UIBezierPath"><a href="#玩一下UIBezierPath" class="headerlink" title="玩一下UIBezierPath"></a>玩一下UIBezierPath</h3><p>在说回 UIBezierPath ，在 UIBezierPath 的 init 方法中，就有很多方便你画各种图形的方法，比如你可以画一个带圆角的图形</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let path = UIBezierPath(roundedRect: CGRectMake(110, 100, 150, 100), cornerRadius: 50)</div><div class="line">let layer = CAShapeLayer()</div><div class="line">layer.path = path.CGPath</div><div class="line">layer.fillColor = UIColor.clearColor().CGColor</div><div class="line">layer.strokeColor = UIColor.blackColor().CGColor</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-9823776fce62dd7e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt=""></p>
<p>还可以指定起始角和半径画圆:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let radius: CGFloat = 60.0</div><div class="line">let startAngle: CGFloat = 0.0</div><div class="line">let endAngle: CGFloat = CGFloat(M_PI * 2)</div><div class="line">let path = UIBezierPath(arcCenter: view.center, radius: radius, startAngle: startAngle, endAngle: endAngle, clockwise: true)</div><div class="line">let layer = CAShapeLayer()</div><div class="line">layer.path = path.CGPath</div><div class="line">layer.fillColor = UIColor.clearColor().CGColor</div><div class="line">layer.strokeColor = UIColor.blackColor().CGColor</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-0d0087ee3b02abc4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt=""></p>
<p>在这里涉及到角度的问题，起始角和结束角，这里的角度使使用弧度制来表示，这里我收藏了一张图片，以方便参考</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-7f77dcb0cc28e0ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="怎么画曲线"><a href="#怎么画曲线" class="headerlink" title="怎么画曲线"></a>怎么画曲线</h3><p>贝塞尔曲线的画法是由起点、终点、控制点三个参数来画的，为了解释清楚这个点，我写了几行代码来解释它</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let startPoint = CGPointMake(50, 300)</div><div class="line">let endPoint = CGPointMake(300, 300)</div><div class="line">let controlPoint = CGPointMake(170, 200)</div><div class="line"></div><div class="line">let layer1 = CALayer()</div><div class="line">layer1.frame = CGRectMake(startPoint.x, startPoint.y, 5, 5)</div><div class="line">layer1.backgroundColor = UIColor.redColor().CGColor</div><div class="line"></div><div class="line">let layer2 = CALayer()</div><div class="line">layer2.frame = CGRectMake(endPoint.x, endPoint.y, 5, 5)</div><div class="line">layer2.backgroundColor = UIColor.redColor().CGColor</div><div class="line"></div><div class="line">let layer3 = CALayer()</div><div class="line">layer3.frame = CGRectMake(controlPoint.x, controlPoint.y, 5, 5)</div><div class="line">layer3.backgroundColor = UIColor.redColor().CGColor</div><div class="line"></div><div class="line">let path = UIBezierPath()</div><div class="line">let layer = CAShapeLayer()</div><div class="line"></div><div class="line">path.moveToPoint(startPoint)</div><div class="line">path.addQuadCurveToPoint(endPoint, controlPoint: controlPoint)</div><div class="line"></div><div class="line">layer.path = path.CGPath</div><div class="line">layer.fillColor = UIColor.clearColor().CGColor</div><div class="line">layer.strokeColor = UIColor.blackColor().CGColor</div><div class="line"></div><div class="line">view.layer.addSublayer(layer)</div><div class="line">view.layer.addSublayer(layer1)</div><div class="line">view.layer.addSublayer(layer2)</div><div class="line">view.layer.addSublayer(layer3)</div></pre></td></tr></table></figure>
<p>我很随意的定义了三个点，为了清楚显示它们的位置，我放了三个矩形在上面以便观察，然后调用 <code>path.moveToPoint(startPoint)</code>让它移动到起始点，然后调用<code>path.addQuadCurveToPoint(endPoint, controlPoint: controlPoint)</code> 这个方法告诉它结束点和控制点，这样它就能画出一条有弧度的线条了，如果把<code>fillColor</code>设置一个颜色，那么它就会变成一个很丑的形状了，示例图如下</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-0d292e7a1fab289b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="image"></p>
<p>控制点决定了它的曲率，曲线的顶点不等于控制点的位置，具体可以看一下贝塞尔曲线的定义，你还可以使用两个控制点来画，两个控制点可以使用方法 path.addCurveToPoint(endPoint, controlPoint1: controlPoint, controlPoint2: controlPoint2)来搞定,这样它会是这个样子</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-f19bd76f1caa0c35.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="image"></p>
<h3 id="再来说说-CAShapeLayer"><a href="#再来说说-CAShapeLayer" class="headerlink" title="再来说说 CAShapeLayer"></a>再来说说 CAShapeLayer</h3><p>CAShapeLayer 是个神奇的东西，给它一个<code>path</code>它就能变成你想要的形状，它还有很多可以玩的地方。综合使用可以组合成不同的动画，比如下面这样<br><img src="http://upload-images.jianshu.io/upload_images/120336-8290d12457b8f5ea.gif?imageMogr2/auto-orient/strip" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-7e70eca941c957c4.gif?imageMogr2/auto-orient/strip" alt="image"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-1899225022c2b637.gif?imageMogr2/auto-orient/strip" alt="image"></p>
<p>这三个动画就是使用了<code>strokeEnd strokeStart lineWidth</code> 三个属性，第一个动画用了<code>strokeEnd</code>这个属性的值范围是0-1，动画显示了从0到1之间每一个值对这条曲线的影响，<code>strokeStart</code>的方法则是相反的，如果把这两个值首先都设置成0.5然后慢慢改变成0和1的时候就会变成第二个动画，配合lineWidth则曲线会慢慢变粗，这里的很多属性都是支持动画的。</p>
<p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">private func animation1() &#123;</div><div class="line">        let animation = CABasicAnimation(keyPath: &quot;strokeEnd&quot;)</div><div class="line">        animation.fromValue = 0</div><div class="line">        animation.toValue = 1</div><div class="line">        animation.duration = 2</div><div class="line">        layer.addAnimation(animation, forKey: &quot;&quot;)</div><div class="line">    &#125;</div><div class="line"></div><div class="line"> private func animation2() &#123;</div><div class="line">     layer.strokeStart = 0.5</div><div class="line">     layer.strokeEnd = 0.5</div><div class="line"></div><div class="line">     let animation = CABasicAnimation(keyPath: &quot;strokeStart&quot;)</div><div class="line">     animation.fromValue = 0.5</div><div class="line">     animation.toValue = 0</div><div class="line">     animation.duration = 2</div><div class="line"></div><div class="line">     let animation2 = CABasicAnimation(keyPath: &quot;strokeEnd&quot;)</div><div class="line">     animation2.fromValue = 0.5</div><div class="line">     animation2.toValue = 1</div><div class="line">     animation2.duration = 2</div><div class="line"></div><div class="line">     layer.addAnimation(animation, forKey: &quot;&quot;)</div><div class="line">     layer.addAnimation(animation2, forKey: &quot;&quot;)</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> private func animation3() &#123;</div><div class="line">     let animation = CABasicAnimation(keyPath: &quot;lineWidth&quot;)</div><div class="line">     animation.fromValue = 1</div><div class="line">     animation.toValue = 10</div><div class="line">     animation.duration = 2</div><div class="line">     layer.addAnimation(animation, forKey: &quot;&quot;)</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h3 id="应用一下"><a href="#应用一下" class="headerlink" title="应用一下"></a>应用一下</h3><p>前一阵子在仿时光网这个APP，其中有一个Layer的形状很怪异，是这样的</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-7b526aaef0bbdc19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="image"></p>
<p>很明显它可以用 CAShapeLayer + UIBezierPath 来做，思路大概是这样，先移动到左上方的位置，然后向下划线，然后往右划线，然后往上划线，还剩一个盖子，这个盖子就用一个控制点控制曲率，非常简单，代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">let finalSize = CGSizeMake(CGRectGetWidth(view.frame), 400)</div><div class="line">let layerHeight = finalSize.height * 0.2</div><div class="line">let layer = CAShapeLayer()</div><div class="line">let bezier = UIBezierPath()</div><div class="line">bezier.moveToPoint(CGPointMake(0, finalSize.height - layerHeight))</div><div class="line">bezier.addLineToPoint(CGPointMake(0, finalSize.height - 1))</div><div class="line">bezier.addLineToPoint(CGPointMake(finalSize.width, finalSize.height - 1))</div><div class="line">bezier.addLineToPoint(CGPointMake(finalSize.width, finalSize.height - layerHeight))</div><div class="line">bezier.addQuadCurveToPoint(CGPointMake(0,finalSize.height - layerHeight),</div><div class="line">    controlPoint: CGPointMake(finalSize.width / 2, (finalSize.height - layerHeight) - 40))</div><div class="line">layer.path = bezier.CGPath</div><div class="line">layer.fillColor = UIColor.blackColor().CGColor</div><div class="line">view.layer.addSublayer(layer)</div></pre></td></tr></table></figure>
<p>就能画出这样的形状来</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-06410bfad53fb73e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/400" alt="image"></p>
<p>再来一个复杂点的，微信下拉拍小视频的那只眼睛很有趣，来模仿一下那个效果吧，它是这样的</p>
<p><img src="http://upload-images.jianshu.io/upload_images/120336-3c41264e40f49e68.gif?imageMogr2/auto-orient/strip" alt="image"><br>首先你得画出这只眼睛，这是眼睛包括5个部分组成（这个是用OC写的）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@property (strong, nonatomic) CAShapeLayer *eyeFirstLightLayer;</div><div class="line">@property (strong, nonatomic) CAShapeLayer *eyeSecondLightLayer;</div><div class="line">@property (strong, nonatomic) CAShapeLayer *eyeballLayer;</div><div class="line">@property (strong, nonatomic) CAShapeLayer *topEyesocketLayer;</div><div class="line">@property (strong, nonatomic) CAShapeLayer *bottomEyesocketLayer;</div></pre></td></tr></table></figure>
<p>然后，还是通过 UIBezierPath 和 CAShapeLayer 这样的老套路来画，代码较多</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line">- (CAShapeLayer *)eyeFirstLightLayer &#123;</div><div class="line">    if (!_eyeFirstLightLayer) &#123;</div><div class="line">        _eyeFirstLightLayer = [CAShapeLayer layer];</div><div class="line">        CGPoint center = CGPointMake(CGRectGetWidth(self.frame) / 2, CGRectGetHeight(self.frame) / 2);</div><div class="line">        UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:center</div><div class="line">                                                            radius:CGRectGetWidth(self.frame) * 0.2</div><div class="line">                                                        startAngle:(230.f / 180.f) * M_PI</div><div class="line">                                                          endAngle:(265.f / 180.f) * M_PI</div><div class="line">                                                         clockwise:YES];</div><div class="line">        _eyeFirstLightLayer.borderColor = [UIColor blackColor].CGColor;</div><div class="line">        _eyeFirstLightLayer.lineWidth = 5.f;</div><div class="line">        _eyeFirstLightLayer.path = path.CGPath;</div><div class="line">        _eyeFirstLightLayer.fillColor = [UIColor clearColor].CGColor;</div><div class="line">        _eyeFirstLightLayer.strokeColor = [UIColor whiteColor].CGColor;</div><div class="line">    &#125;</div><div class="line">    return _eyeFirstLightLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (CAShapeLayer *)eyeSecondLightLayer &#123;</div><div class="line">    if (!_eyeSecondLightLayer) &#123;</div><div class="line">        _eyeSecondLightLayer = [CAShapeLayer layer];</div><div class="line">        CGPoint center = CGPointMake(CGRectGetWidth(self.frame) / 2, CGRectGetHeight(self.frame) / 2);</div><div class="line">        UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:center</div><div class="line">                                                            radius:CGRectGetWidth(self.frame) * 0.2</div><div class="line">                                                        startAngle:(211.f / 180.f) * M_PI</div><div class="line">                                                          endAngle:(220.f / 180.f) * M_PI</div><div class="line">                                                         clockwise:YES];</div><div class="line">        _eyeSecondLightLayer.borderColor = [UIColor blackColor].CGColor;</div><div class="line">        _eyeSecondLightLayer.lineWidth = 5.f;</div><div class="line">        _eyeSecondLightLayer.path = path.CGPath;</div><div class="line">        _eyeSecondLightLayer.fillColor = [UIColor clearColor].CGColor;</div><div class="line">        _eyeSecondLightLayer.strokeColor = [UIColor whiteColor].CGColor;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return _eyeSecondLightLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (CAShapeLayer *)eyeballLayer &#123;</div><div class="line">    if (!_eyeballLayer) &#123;</div><div class="line">        _eyeballLayer = [CAShapeLayer layer];</div><div class="line">        CGPoint center = CGPointMake(CGRectGetWidth(self.frame) / 2, CGRectGetHeight(self.frame) / 2);</div><div class="line">        UIBezierPath *path = [UIBezierPath bezierPathWithArcCenter:center</div><div class="line">                                                            radius:CGRectGetWidth(self.frame) * 0.3</div><div class="line">                                                        startAngle:(0.f / 180.f) * M_PI</div><div class="line">                                                          endAngle:(360.f / 180.f) * M_PI</div><div class="line">                                                         clockwise:YES];</div><div class="line">        _eyeballLayer.borderColor = [UIColor blackColor].CGColor;</div><div class="line">        _eyeballLayer.lineWidth = 1.f;</div><div class="line">        _eyeballLayer.path = path.CGPath;</div><div class="line">        _eyeballLayer.fillColor = [UIColor clearColor].CGColor;</div><div class="line">        _eyeballLayer.strokeColor = [UIColor whiteColor].CGColor;</div><div class="line">        _eyeballLayer.anchorPoint = CGPointMake(0.5, 0.5);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return _eyeballLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (CAShapeLayer *)topEyesocketLayer &#123;</div><div class="line">    if (!_topEyesocketLayer) &#123;</div><div class="line">        _topEyesocketLayer = [CAShapeLayer layer];</div><div class="line">        CGPoint center = CGPointMake(CGRectGetWidth(self.frame) / 2, CGRectGetHeight(self.frame) / 2);</div><div class="line">        UIBezierPath *path = [UIBezierPath bezierPath];</div><div class="line">        [path moveToPoint:CGPointMake(0, CGRectGetHeight(self.frame) / 2)];</div><div class="line">        [path addQuadCurveToPoint:CGPointMake(CGRectGetWidth(self.frame), CGRectGetHeight(self.frame) / 2)</div><div class="line">                     controlPoint:CGPointMake(CGRectGetWidth(self.frame) / 2, center.y - center.y - 20)];</div><div class="line">        _topEyesocketLayer.borderColor = [UIColor blackColor].CGColor;</div><div class="line">        _topEyesocketLayer.lineWidth = 1.f;</div><div class="line">        _topEyesocketLayer.path = path.CGPath;</div><div class="line">        _topEyesocketLayer.fillColor = [UIColor clearColor].CGColor;</div><div class="line">        _topEyesocketLayer.strokeColor = [UIColor whiteColor].CGColor;</div><div class="line">    &#125;</div><div class="line">    return _topEyesocketLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (CAShapeLayer *)bottomEyesocketLayer &#123;</div><div class="line">    if (!_bottomEyesocketLayer) &#123;</div><div class="line">        _bottomEyesocketLayer = [CAShapeLayer layer];</div><div class="line">        CGPoint center = CGPointMake(CGRectGetWidth(self.frame) / 2, CGRectGetHeight(self.frame) / 2);</div><div class="line">        UIBezierPath *path = [UIBezierPath bezierPath];</div><div class="line">        [path moveToPoint:CGPointMake(0, CGRectGetHeight(self.frame) / 2)];</div><div class="line">        [path addQuadCurveToPoint:CGPointMake(CGRectGetWidth(self.frame), CGRectGetHeight(self.frame) / 2)</div><div class="line">                     controlPoint:CGPointMake(CGRectGetWidth(self.frame) / 2, center.y + center.y + 20)];</div><div class="line">        _bottomEyesocketLayer.borderColor = [UIColor blackColor].CGColor;</div><div class="line">        _bottomEyesocketLayer.lineWidth = 1.f;</div><div class="line">        _bottomEyesocketLayer.path = path.CGPath;</div><div class="line">        _bottomEyesocketLayer.fillColor = [UIColor clearColor].CGColor;</div><div class="line">        _bottomEyesocketLayer.strokeColor = [UIColor whiteColor].CGColor;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return _bottomEyesocketLayer;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后更改一下某些属性的值，方便稍后的动画</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (void)setupAnimation &#123;</div><div class="line">    self.eyeFirstLightLayer.lineWidth = 0.f;</div><div class="line">    self.eyeSecondLightLayer.lineWidth = 0.f;</div><div class="line">    self.eyeballLayer.opacity = 0.f;</div><div class="line">    _bottomEyesocketLayer.strokeStart = 0.5f;</div><div class="line">    _bottomEyesocketLayer.strokeEnd = 0.5f;</div><div class="line">    _topEyesocketLayer.strokeStart = 0.5f;</div><div class="line">    _topEyesocketLayer.strokeEnd = 0.5f;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后根据 UIScrollView 的 <code>contentOffset</code> 来控制各种属性，办法较笨，但管用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">- (void)animationWith:(CGFloat)y &#123;</div><div class="line">    CGFloat flag = self.frame.origin.y * 2.f - 20.f;</div><div class="line">    if (y &lt; flag) &#123;</div><div class="line">        if (self.eyeFirstLightLayer.lineWidth &lt; 5.f) &#123;</div><div class="line">            self.eyeFirstLightLayer.lineWidth += 1.f;</div><div class="line">            self.eyeSecondLightLayer.lineWidth += 1.f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if(y &lt; flag - 20) &#123;</div><div class="line">        if (self.eyeballLayer.opacity &lt;= 1.0f) &#123;</div><div class="line">            self.eyeballLayer.opacity += 0.1f;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (y &lt; flag - 40) &#123;</div><div class="line">        if (self.topEyesocketLayer.strokeEnd &lt; 1.f &amp;&amp; self.topEyesocketLayer.strokeStart &gt; 0.f) &#123;</div><div class="line">            self.topEyesocketLayer.strokeEnd += 0.1f;</div><div class="line">            self.topEyesocketLayer.strokeStart -= 0.1f;</div><div class="line">            self.bottomEyesocketLayer.strokeEnd += 0.1f;</div><div class="line">            self.bottomEyesocketLayer.strokeStart -= 0.1f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (y &gt; flag - 40) &#123;</div><div class="line">        if (self.topEyesocketLayer.strokeEnd &gt; 0.5f &amp;&amp; self.topEyesocketLayer.strokeStart &lt; 0.5f) &#123;</div><div class="line">            self.topEyesocketLayer.strokeEnd -= 0.1f;</div><div class="line">            self.topEyesocketLayer.strokeStart += 0.1f;</div><div class="line">            self.bottomEyesocketLayer.strokeEnd -= 0.1f;</div><div class="line">            self.bottomEyesocketLayer.strokeStart += 0.1f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (y &gt; flag - 20) &#123;</div><div class="line">        if (self.eyeballLayer.opacity &gt;= 0.0f) &#123;</div><div class="line">            self.eyeballLayer.opacity -= 0.1f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (y &gt; flag) &#123;</div><div class="line">        if (self.eyeFirstLightLayer.lineWidth &gt; 0.f) &#123;</div><div class="line">            self.eyeFirstLightLayer.lineWidth -= 1.f;</div><div class="line">            self.eyeSecondLightLayer.lineWidth -= 1.f;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p>总之使用 UIbezierPath 和 CAShapeLayer 可以画出你想要的任何形状，没有它做不到，只有你想不到，搞定了它们你就可以轻松定制你想要的任何控件了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://wuzhi.me/avatar/112063.1460211687.jpg"
               alt="shiron" />
          <p class="site-author-name" itemprop="name">shiron</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">28</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shiron</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  

  

  

  

</body>
</html>
